---
layout: default
title: "Media"
permalink: /media/
classes: media-page
hide_captions: false
---

<style>
  /* Maximum specificity - target the exact page structure */
  body .page__inner-wrap .media-page .media-card,
  body .media-page .media-card,
  .media-card {
    min-width: 0 !important;
    background: #fff !important;
    border: 1px solid #e1e4e8 !important;
    border-radius: 8px !important;
    padding: 1rem !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
    margin: 0 !important;
    display: block !important;
    width: 100% !important;
    box-sizing: border-box !important;
    transition: box-shadow 0.2s ease !important;
  }
  
  /* Hover effect for cards */
  .media-card:hover {
    box-shadow: 0 4px 8px rgba(0,0,0,0.15) !important;
    border-color: #d1d5da !important;
  }
  
  /* Grid container with separate horizontal and vertical gaps */
  body .media-page .media-grid,
  .media-grid {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
    grid-auto-rows: 20px !important; /* Row height for masonry calculation */
    row-gap: 1px !important; /* Vertical gap between rows */
    column-gap: 20px !important; /* Horizontal gap between columns */
    align-items: start !important;
    width: 100% !important;
    max-width: none !important;
    padding: 0 !important;
    margin: 20px 0 !important;
  }
  
  /* Ensure full width for default layout */
  body .media-page {
    max-width: none !important;
    width: 100% !important;
    padding: 0 20px !important;
  }
  
  /* Spacing with higher specificity */
  .media-page .media-card h3,
  body .media-card h3 { 
    margin: 0 0 0.25rem !important; 
    font-size: 1rem !important;
    color: #333 !important;
  }
  
  .media-page .publication-meta,
  body .media-card .publication-meta { 
    margin: 0 0 0.5rem !important; 
    color: #666 !important; 
    font-size: 0.9rem !important;
  }
  
  .media-page .media-summary,
  body .media-card .media-summary { 
    margin-top: 0.5rem !important;
    font-size: 0.9rem !important;
  }
  
  /* Teaser image styling */
  .media-page .media-card .teaser-image,
  body .media-card .teaser-image {
    width: 100% !important;
    height: auto !important;
    border-radius: 4px !important;
    margin-bottom: 0.5rem !important;
  }
</style>

<h1>Media</h1>

<section class="media-grid">
  {% assign media_items = site.media | sort: "date" | reverse %}
  {% for item in media_items %}
    <article class="media-card">
      
      {% if item.date %}
        <p class="publication-meta">
          <time datetime="{{ item.date | date_to_xmlschema }}">{{ item.date | date: "%B %Y" }}</time>
        </p>
      {% endif %}

      <h3 class="archive__item-title">
        {% if item.link %}<a href="{{ item.link }}">{{ item.title }}</a>{% else %}{{ item.title }}{% endif %}
      </h3>

      {% if item.summary or item.excerpt %}
        <div class="media-summary">{{ item.summary | default: item.excerpt | markdownify }}</div>
      {% endif %}

      {% if item.header.teaser %}
        <img src="{{ site.baseurl }}/images/{{ item.header.teaser }}" alt="{{ item.title }}" class="teaser-image">
      {% endif %}

      <div class="media-embed">
        {% if page.hide_captions %}
          {{ item.content | replace: 'data-instgrm-captioned', '' }}
        {% else %}
          {{ item.content }}
        {% endif %}
      </div>
    </article>
  {% endfor %}
</section>

<script>
var lastHeights = [];
var masonryAttempts = 0;
var isStable = false;

function applyMasonry() {
  var grid = document.querySelector('.media-grid');
  var items = grid.querySelectorAll('.media-card');
  
  var rowHeight = 20; // Match CSS grid-auto-rows
  var verticalGap = 1; // Match CSS row-gap
  
  masonryAttempts++;
  
  // Check current heights first
  var currentHeights = [];
  for (var i = 0; i < items.length; i++) {
    var rect = items[i].getBoundingClientRect();
    currentHeights.push(rect.height);
  }
  
  // Only proceed if heights have changed or this is the first run
  var heightsChanged = JSON.stringify(currentHeights) !== JSON.stringify(lastHeights);
  
  if (!heightsChanged && masonryAttempts > 1) {
    if (!isStable) {
      isStable = true; // Mark as stable, stop periodic checks
    }
    return; // No need to recalculate
  }
  
  lastHeights = currentHeights.slice();
  
  // Reset all items first
  for (var i = 0; i < items.length; i++) {
    items[i].style.gridRowEnd = 'auto';
  }
  
  // Force reflow
  grid.offsetHeight;
  
  // Wait for content to settle, then calculate
  setTimeout(function() {
    for (var i = 0; i < items.length; i++) {
      var rect = items[i].getBoundingClientRect();
      var itemHeight = rect.height;
      
      var rowSpan = Math.ceil((itemHeight + verticalGap) / rowHeight);
      items[i].style.gridRowEnd = 'span ' + rowSpan;
    }
  }, 100);
}

// Initial load timing - less aggressive
setTimeout(applyMasonry, 500);
setTimeout(applyMasonry, 1500);
setTimeout(applyMasonry, 3000);
setTimeout(applyMasonry, 6000);

window.addEventListener('resize', function() {
  isStable = false; // Reset stability on resize
  setTimeout(applyMasonry, 300);
});

// Handle Instagram embeds
function handleInstagramEmbeds() {
  if (window.instgrm && window.instgrm.Embeds) {
    window.instgrm.Embeds.process();
    setTimeout(function() {
      isStable = false; // Reset stability when Instagram loads
      applyMasonry();
    }, 2000);
  }
}

setTimeout(handleInstagramEmbeds, 2000);
setTimeout(handleInstagramEmbeds, 5000);

// Only check periodically if not stable, and less frequently
var periodicCheck = setInterval(function() {
  if (!isStable && masonryAttempts < 20) {
    applyMasonry();
  } else {
    clearInterval(periodicCheck);
  }
}, 5000); // Every 5 seconds instead of 2
</script>

<script async src="https://www.instagram.com/embed.js"></script>
